# Конфигурация Cursor/VS Code для проекта

## Запуск проекта через UI

### Способ 1: Через панель Debug (F5)

1. Откройте панель **Run and Debug** (Ctrl+Shift+D)
2. Выберите одну из конфигураций:
   - **Run Telegram Bot** - запуск бота в обычном режиме
   - **Debug Telegram Bot** - запуск бота в режиме отладки с уровнем логирования DEBUG

3. Нажмите зеленую кнопку запуска (▶) или F5

### Способ 2: Через Tasks (Ctrl+Shift+P)

1. Откройте командную палитру: `Ctrl+Shift+P`
2. Введите: `Tasks: Run Task`
3. Выберите задачу:
   - **Run Bot** - запуск бота

## Запуск тестов через UI

### Способ 1: Через панель Testing (встроенный тест-раннер)

1. Откройте панель **Testing** в левой панели (иконка с колбой)
2. Нажмите кнопку **Refresh Tests** для обнаружения тестов
3. Запускайте тесты:
   - Нажмите ▶ рядом с конкретным тестом
   - Нажмите ▶ на уровне файла для запуска всех тестов в файле
   - Нажмите ▶ на верхнем уровне для запуска всех тестов

### Способ 2: Через панель Debug (F5)

1. Откройте панель **Run and Debug** (Ctrl+Shift+D)
2. Выберите конфигурацию:
   - **Run Tests** - запуск всех тестов
   - **Run Tests with Coverage** - запуск тестов с отчетом о покрытии
   - **Debug Current Test File** - отладка текущего открытого тестового файла

3. Нажмите F5 или зеленую кнопку запуска

### Способ 3: Через Tasks (Ctrl+Shift+P)

1. Откройте командную палитру: `Ctrl+Shift+P`
2. Введите: `Tasks: Run Task`
3. Выберите задачу:
   - **Run Tests** - запуск всех тестов
   - **Run Tests with Coverage** - запуск с покрытием

## Дополнительные задачи

Через `Ctrl+Shift+P` → `Tasks: Run Task` доступны:

- **Setup Environment** - установка зависимостей (`uv sync --all-extras`)
- **Format Code** - форматирование кода через Ruff
- **Lint Code** - проверка линтером
- **Type Check** - проверка типов через mypy
- **Quality Check (All)** - полная проверка качества кода (формат + линт + типы + тесты)
- **Clean** - очистка кеша и виртуального окружения

## Настройки редактора

Файл `settings.json` включает:

- ✅ Автоматическое форматирование при сохранении
- ✅ Организация импортов при сохранении
- ✅ Интеграция с pytest для тестов
- ✅ Ruff как форматтер и линтер
- ✅ Базовая проверка типов

## Горячие клавиши

- `F5` - запуск выбранной конфигурации отладки
- `Ctrl+Shift+D` - открыть панель Debug
- `Ctrl+Shift+P` - командная палитра
- `Ctrl+Shift+B` - запустить задачу по умолчанию (Run Bot)
- `Shift+Alt+F` - форматировать документ

## Требования

Убедитесь, что установлены расширения:
- **Python** (Microsoft)
- **Ruff** (Astral Software)
- **Pylance** (Microsoft, обычно идет с Python)

## Переменные окружения

Убедитесь, что создан файл `.env` с необходимыми переменными:
```env
TELEGRAM_BOT_TOKEN=your_token_here
OPENROUTER_API_KEY=your_api_key_here
OPENROUTER_MODEL=anthropic/claude-3.5-sonnet
LOG_LEVEL=INFO
MAX_HISTORY_MESSAGES=10
LLM_TIMEOUT=30
```

## Решение возможных проблем

### ModuleNotFoundError: No module named 'bot'

Если при запуске через дебаг вы получаете ошибку импорта модулей, убедитесь что:

1. В `.vscode/launch.json` установлен правильный `PYTHONPATH`:
   ```json
   "env": {
     "PYTHONPATH": "${workspaceFolder}/src"
   }
   ```

2. В `.vscode/settings.json` добавлен путь для анализатора:
   ```json
   "python.analysis.extraPaths": [
     "${workspaceFolder}/src"
   ]
   ```

3. Файл `tests/conftest.py` содержит настройку путей (уже настроено)

### Не найдены переменные окружения

Создайте файл `.env` в корне проекта с необходимыми переменными (см. выше).

